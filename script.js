// Language content objects
const content = {
    ru: {
        themeToggle: {
            light: 'Ночью',
            dark: 'Днём'
        },
        languageToggle: 'Eng',
        meta: {
            title: 'Работа Данияра Агабекова',
            description: 'Ищете копирайтера? Это я.'
        },
        name: 'Данияр Агабеков',
        title: 'Хороший текст начинается с разговора. Напишите: agabekov@proton.me',
        sections: {
            about: {
                title: 'Обо мне',
                content: [
                    'Я пишу тексты. Пишу уже 11&nbsp;лет. И делаю это довольно хорошо.',
                    'Лучше всего я умею две вещи.',
                    'Писать с&nbsp;заботой&nbsp;— чтобы люди чувствовали любовь и&nbsp;уважение к&nbsp;себе, чтобы они не&nbsp;думали, что они глупые, когда пользуются вашими продуктами, чтобы чувствовали, что о&nbsp;них переживают, и&nbsp;что им&nbsp;хотят помочь.',
                    'Могу помочь, когда наступают сложные моменты&nbsp;— когда нужно сообщить клиентам непростую новость или объяснить изменения, которые могут вызвать беспокойство. <span class="highlight">Я&nbsp;тщательно подбираю каждое слово, чтобы сохранить доверие, которое вы&nbsp;строили годами.</span> Я&nbsp;помогаю вашим клиентам понять, что даже в&nbsp;непростых ситуациях вы&nbsp;остаётесь на&nbsp;их&nbsp;стороне, цените их&nbsp;и&nbsp;стремитесь сделать всё возможное, чтобы ваши отношения продолжались и&nbsp;крепли, несмотря на&nbsp;временные трудности.',
                    'И&nbsp;формулировать смыслы&nbsp;— превращать сложные идеи в&nbsp;ясные сообщения, которые находят отклик. Я&nbsp;помогаю компаниям выражать их&nbsp;ценности так, чтобы каждый понял суть без лишних слов. Создаю тексты, где за&nbsp;каждым предложением стоит цель и&nbsp;намерение, где нет места пустым фразам. <span class="highlight">Когда люди читают мои тексты, они видят картину целиком, понимают «почему» за&nbsp;каждым «что» и&nbsp;чувствуют связь с&nbsp;брендом на&nbsp;более глубоком уровне.</span>',
                    'Выступление перед коллегами, презентация для клиентов, текст на&nbsp;сайте или в&nbsp;приложении, содержание буклета, личное письмо, ответы службы поддержки, шаблоны вакансий или пресс-релиз. В&nbsp;общем-то, я&nbsp;могу написать практически любой текст для вашей компании.'
                ]
            },
            services: {
                title: 'Что умею',
                content: [
                    {
                        title: 'Маркетинговый копирайтинг',
                        text: 'Объясняю, чем вы&nbsp;полезны клиентам и&nbsp;почему вас стоит выбрать. Не&nbsp;давлю на&nbsp;людей и&nbsp;не&nbsp;использую маркетинговые штампы&nbsp;— просто даю информацию, которая помогает принять решение в&nbsp;вашу пользу.'
                    },
                    {
                        title: 'UX-копирайтинг',
                        text: 'Пишу для приложений и&nbsp;сайтов так, чтобы не&nbsp;запутать, а&nbsp;помочь. Сделать взаимодействие с&nbsp;вашим продуктом приятным и&nbsp;понятным. Когда пользователь увидит текст, он&nbsp;сразу понимает, что происходит и&nbsp;что делать дальше.'
                    },
                    {
                        title: 'Гострайтинг',
                        text: 'Изучаю особенности вашей речи, а&nbsp;затем создаю тексты, которые звучат так, будто вы&nbsp;написали их&nbsp;сами. Это всё останется анонимным, никто не&nbsp;узнает о&nbsp;моей работе.',
                        additionalText: 'Руковожу своей студией гострайтинга. Работаем с корпорациями, стартапами и экспертами. <a href="https://noname.daniyar.link" target="_blank">Подробнее</a>'
                    }
                ]
            },
            clients: {
                title: 'С кем работал',
                intro: 'С&nbsp;одними работали долго и&nbsp;сделали много, а&nbsp;с&nbsp;кем-то&nbsp;— совсем чуть-чуть. Но&nbsp;я&nbsp;всех помню и&nbsp;люблю.'
            },
            workExperience: {
                title: 'Где работал',
                inStaff: 'В штате',
                freelance: 'Проектно',
                positions: {
                    'Продуктовый редактор': 'Product Editor',
                    'Редактор коммуникаций и&nbsp;менеджер спецпроектов': 'Communications Editor & Special Projects Manager',
                    'Редактор коммуникаций и продуктов': 'Communications and Product Editor',
                    'Старший копирайтер': 'Senior Copywriter',
                    'Автор рассылки': 'Newsletter Writer',
                    'Копирайтер': 'Copywriter'
                }
            },
            education: {
                title: 'Когда учился'
            },
            contact: {
                title: 'Как связаться'
            }
        }
    },
    en: {
        themeToggle: {
            light: 'Night',
            dark: 'Day'
        },
        languageToggle: 'Рус',
        meta: {
            title: 'Daniyar Agabekov\'s Work',
            description: 'Looking for a copywriter? That\'s me.'
        },
        name: 'Daniyar Agabekov',
        title: 'Great copy starts with a conversation. Email me: agabekov@proton.me',
        sections: {
            about: {
                title: 'About me',
                content: [
                    'I write copy. I\'ve been writing for 11 years. And I'm pretty good at it.',
                    'I\'m best at two things.',
                    'I write with care — so people feel loved and respected, so they never feel stupid when using your products, so they know you genuinely care about them and want to help.',
                    'I can help when things get tough — when you need to deliver difficult news to customers or explain changes that might cause concern. <span class="highlight">I carefully choose every word to preserve the trust you\'ve spent years building.</span> I help your customers understand that even in challenging situations, you\'re still on their side, you value them, and you\'re committed to doing everything possible to keep your relationship strong, despite temporary difficulties.',
                    'And I shape ideas — turning complex concepts into clear messages that resonate. I help companies express their values so everyone gets the essence without unnecessary words. I create copy where every sentence has purpose and intention, where there\'s no room for empty phrases. <span class="highlight">When people read my work, they see the full picture, understand the "why" behind every "what," and feel connected to the brand on a deeper level.</span>',
                    'A presentation to colleagues, a client presentation, website or app copy, brochure content, personal letters, support responses, job posting templates, or press releases. Basically, I can write almost any text for your company.'
                ]
            },
            services: {
                title: 'What I do',
                content: [
                    {
                        title: 'Marketing copywriting',
                        text: 'I explain how you\'re useful to clients and why they should choose you. I don\'t pressure people or use marketing clichés — I just provide information that helps them decide in your favor.'
                    },
                    {
                        title: 'UX copywriting',
                        text: 'I write for apps and websites to help, not confuse. Making interaction with your product pleasant and clear. When a user sees the text, they immediately understand what\'s happening and what to do next.'
                    },
                    {
                        title: 'Ghostwriting',
                        text: 'I study the features of your speech, then create texts that sound like you wrote them yourself. This all remains anonymous, no one will know about my work.',
                        additionalText: 'I run my own ghostwriting studio. We work with corporations, startups and experts. <a href="https://noname.daniyar.link" target="_blank">Learn more</a>'
                    }
                ]
            },
            clients: {
                title: 'Who I worked with',
                intro: 'With some we worked long and did a lot, and with others — just a little bit. But I remember and love them all.'
            },
            workExperience: {
                title: 'Where I worked',
                inStaff: 'Full-time',
                freelance: 'Project-based',
                positions: {
                    'Продуктовый редактор': 'Product Editor',
                    'Редактор коммуникаций и&nbsp;менеджер спецпроектов': 'Communications Editor & Special Projects Manager',
                    'Редактор коммуникаций и продуктов': 'Communications and Product Editor',
                    'Старший копирайтер': 'Senior Copywriter',
                    'Автор рассылки': 'Newsletter Writer',
                    'Копирайтер': 'Copywriter'
                }
            },
            education: {
                title: 'Education'
            },
            contact: {
                title: 'Contact'
            }
        }
    }
};

document.addEventListener('DOMContentLoaded', function() {
    // Language toggle functionality
    const languageToggle = document.querySelector('.language-toggle');
    let currentLanguage = localStorage.getItem('language') || 'ru';
    
    // Apply language on page load
    applyLanguage(currentLanguage);
    
    // Language toggle event listener
    languageToggle.addEventListener('click', function() {
        currentLanguage = currentLanguage === 'ru' ? 'en' : 'ru';
        localStorage.setItem('language', currentLanguage);
        applyLanguage(currentLanguage);
        
        // Make all content visible after language change
        showAllContent();
    });
    
    // Function to apply language
    function applyLanguage(lang) {
        const langContent = content[lang];
        
        // Update meta tags
        document.title = langContent.meta.title;
        document.querySelector('meta[name="description"]').setAttribute('content', langContent.meta.description);
        document.querySelector('meta[property="og:title"]').setAttribute('content', langContent.meta.title);
        document.querySelector('meta[property="og:description"]').setAttribute('content', langContent.meta.description);
        document.querySelector('meta[property="twitter:title"]').setAttribute('content', langContent.meta.title);
        document.querySelector('meta[property="twitter:description"]').setAttribute('content', langContent.meta.description);
        
        // Update language toggle button
        languageToggle.textContent = langContent.languageToggle;
        
        // Update theme toggle button text
        const isDark = document.body.classList.contains('dark-theme');
        const themeToggle = document.querySelector('.theme-toggle');
        themeToggle.textContent = isDark ? langContent.themeToggle.dark : langContent.themeToggle.light;
        
        // Update header content
        document.getElementById('name').textContent = langContent.name;
        document.getElementById('title').textContent = langContent.title;
        
        // Update section titles
        document.querySelector('#about h2').textContent = langContent.sections.about.title;
        document.querySelector('#services h2').textContent = langContent.sections.services.title;
        document.querySelector('#clients h2').textContent = langContent.sections.clients.title;
        document.querySelector('#work-experience h2').textContent = langContent.sections.workExperience.title;
        document.querySelector('#education h2').textContent = langContent.sections.education.title;
        document.querySelector('#contact h2').textContent = langContent.sections.contact.title;
        
        // Update about section content
        const aboutContent = document.querySelector('#about .content');
        aboutContent.innerHTML = langContent.sections.about.content.map(p => `<p>${p}</p>`).join('');
        
        // Update services section content
        const servicesContent = document.querySelector('#services .content');
        let servicesHtml = '';
        langContent.sections.services.content.forEach(service => {
            servicesHtml += `<div class="service"><h3>${service.title}</h3><p>${service.text}</p>`;
            if (service.additionalText) {
                servicesHtml += `<p>${service.additionalText}</p>`;
            }
            servicesHtml += '</div>';
        });
        servicesContent.innerHTML = servicesHtml;
        
        // Update clients section intro
        const clientsContent = document.querySelector('#clients .content');
        const clientsIntro = clientsContent.querySelector('p');
        if (clientsIntro) {
            clientsIntro.innerHTML = langContent.sections.clients.intro;
        }
        
        // Update work experience section headers
        const workSectionTitles = document.querySelectorAll('.work-section-title');
        if (workSectionTitles[0]) workSectionTitles[0].textContent = langContent.sections.workExperience.inStaff;
        if (workSectionTitles[1]) workSectionTitles[1].textContent = langContent.sections.workExperience.freelance;
        
        // Update work experience positions
        const positions = document.querySelectorAll('.position');
        positions.forEach(position => {
            const originalText = position.textContent;
            if (langContent.sections.workExperience.positions[originalText]) {
                position.textContent = langContent.sections.workExperience.positions[originalText];
            }
        });
    }
    
    // Function to show all content immediately
    function showAllContent() {
        const sections = document.querySelectorAll('.typed-section');
        sections.forEach(section => {
            const content = section.querySelector('.content');
            if (content) {
                content.style.opacity = '1';
                content.classList.add('typed');
                
                // Make all text elements visible
                const textElements = content.querySelectorAll('p, h3, h4, li, blockquote p, cite, .client-item, .education-item, .work-period, .company-name, .social a');
                textElements.forEach(element => {
                    element.style.opacity = '1';
                    element.style.minHeight = '';
                    element.classList.remove('typing', 'no-cursor');
                });
            }
        });
    }
    
    // Theme toggle functionality
    const themeToggle = document.querySelector('.theme-toggle');
    const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
    
    // Check for saved theme preference or use system preference
    let currentTheme = localStorage.getItem('theme');
    const userHasManualPreference = currentTheme !== null;
    
    // If no manual preference, use system preference
    if (!userHasManualPreference) {
        currentTheme = prefersDarkScheme.matches ? 'dark' : 'light';
    }
    
    // Apply theme on page load
    if (currentTheme === 'dark') {
        document.body.classList.add('dark-theme');
        themeToggle.textContent = content[currentLanguage].themeToggle.dark;
    } else {
        document.body.classList.remove('dark-theme');
        themeToggle.textContent = content[currentLanguage].themeToggle.light;
    }
    
    // Toggle theme when button is clicked
    themeToggle.addEventListener('click', function() {
        document.body.classList.toggle('dark-theme');
        
        // Update button text based on current theme
        const isDark = document.body.classList.contains('dark-theme');
        themeToggle.textContent = isDark ? content[currentLanguage].themeToggle.dark : content[currentLanguage].themeToggle.light;
        
        // Save manual preference to localStorage
        localStorage.setItem('theme', isDark ? 'dark' : 'light');
    });
    
    // Listen for changes in system color scheme preference
    prefersDarkScheme.addEventListener('change', function(e) {
        // Only apply system preference if user hasn't set a manual preference
        if (!localStorage.getItem('theme')) {
            if (e.matches) {
                document.body.classList.add('dark-theme');
                themeToggle.textContent = content[currentLanguage].themeToggle.dark;
            } else {
                document.body.classList.remove('dark-theme');
                themeToggle.textContent = content[currentLanguage].themeToggle.light;
            }
        }
    });

    // Initial animation for header
    const name = document.getElementById('name');
    const title = document.getElementById('title');
    
    setTimeout(() => {
        name.style.opacity = '1';
        title.style.opacity = '1';
    }, 300);

    // Scroll-based section activation
    const sections = document.querySelectorAll('.typed-section');
    
    // Observer for section visibility
    const sectionObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('visible');
                
                // Show content immediately when section is visible
                const content = entry.target.querySelector('.content');
                if (content && !content.classList.contains('typed')) {
                    content.style.opacity = '1';
                    const textElements = content.querySelectorAll('p, h3, h4, li, blockquote p, cite, .client-item, .education-item, .work-period, .company-name, .social a');
                    textElements.forEach(element => {
                        element.style.opacity = '1';
                    });
                    content.classList.add('typed');
                }
            }
        });
    }, { threshold: 0.2 });
    
    // Observe all sections
    sections.forEach(section => {
        sectionObserver.observe(section);
    });
    
    // Smooth scrolling for navigation links
    const navLinks = document.querySelectorAll('nav a');
    
    navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            
            const targetId = this.getAttribute('href');
            const targetElement = document.querySelector(targetId);
            
            window.scrollTo({
                top: targetElement.offsetTop - 40,
                behavior: 'smooth'
            });
        });
    });
}); 